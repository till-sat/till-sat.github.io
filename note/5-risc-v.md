# RISC-V

## 1. Instruction
### 1.1 Instruction type
| Type   | Usage                            |
| ------ | -------------------------------- |
| R-type | for register-register operations |
| I-type | for short immediates and loads   |
| S-type | for stores                       |
| B-type | for conditional branches         |
| U-type | for long immediates              |
| J-type | for unconditional jumps          |

### 1.2 Instruction formats
```
 V U T S R Q P O N M L K Z I H G F E D C B A 9 8 7 6 5 4 3 2 1 0
+-----------------------+---------+-----+---------+-------------+
|    func7    |   rs2   |   rs1   |func3|   rd    |    opcode   | R-type
+-----------------------+---------+-----+---------+-------------+
+-----------------------+---------+-----+---------+-------------+
|       imm[11:0]       |   rs1   |func3|   rd    |    opcode   | I-type
+-----------------------+---------+-----+---------+-------------+
+-------------+---------+---------+-----+---------+-------------+
|  imm[11:5]  |   rs2   |   rs1   |func3|imm[4:0] |    opcode   | S-type
+-------------+---------+---------+-----+---------+-------------+
+-------------+---------+---------+-----+---------+-------------+
|i| imm[10:5] |   rs2   |   rs1   |func3|  imm  |i|    opcode   | B-type
+-------------+---------+---------+-----+---------+-------------+
+---------------------------------------+---------+-------------+
|            imm[31:12]                 |   rd    |    opcode   | U-type
+---------------------------------------+---------+-------------+
+---------------------------------------+---------+-------------+
|i|     imm[10:1]     |i|  imm[19:12]   |   rd    |    opcode   | J-type
+---------------------------------------+---------+-------------+
```
### 1.3 Instruction domain
| Domain | Usage                                |
| ------ | ------------------------------------ |
| opcode | instruction type                     |
| rs     | source register                      |
| rd     | destination register                 |
| imm    | immediate number                     |
| funct  | support **opcode** for instruction type  |      

### 1.4 Instruction Layout
```
 V U T S R Q P O N M L K Z I H G F E D C B A 9 8 7 6 5 4 3 2 1 0
+-----------------------+---------+-----+---------+-------------+
|0 0 0 0 0 0 0|   rs2   |   rs1   |0 0 0|   rd    |0 1 1 0 0 1 1| R-add
+-----------------------+---------+-----+---------+-------------+
|0 1 0 0 0 0 0|   rs2   |   rs1   |0 0 0|   rd    |0 1 1 0 0 1 1| R-sub
+-----------------------+---------+-----+---------+-------------+
|0 0 0 0 0 0 0|   rs2   |   rs1   |0 0 1|   rd    |0 1 1 0 0 1 1| R-sll
+-----------------------+---------+-----+---------+-------------+
|0 0 0 0 0 0 0|   rs2   |   rs1   |0 1 0|   rd    |0 1 1 0 0 1 1| R-slt
+-----------------------+---------+-----+---------+-------------+
|0 0 0 0 0 0 0|   rs2   |   rs1   |0 1 1|   rd    |0 1 1 0 0 1 1| R-sltu
+-----------------------+---------+-----+---------+-------------+
|0 0 0 0 0 0 0|   rs2   |   rs1   |1 0 0|   rd    |0 1 1 0 0 1 1| R-xor
+-----------------------+---------+-----+---------+-------------+
|0 0 0 0 0 0 0|   rs2   |   rs1   |1 0 1|   rd    |0 1 1 0 0 1 1| R-srl
+-----------------------+---------+-----+---------+-------------+
|0 1 0 0 0 0 0|   rs2   |   rs1   |1 0 1|   rd    |0 1 1 0 0 1 1| R-sra
+-----------------------+---------+-----+---------+-------------+
|0 0 0 0 0 0 0|   rs2   |   rs1   |1 1 0|   rd    |0 1 1 0 0 1 1| R-or
+-----------------------+---------+-----+---------+-------------+
|0 0 0 0 0 0 0|   rs2   |   rs1   |1 1 1|   rd    |0 1 1 0 0 1 1| R-and
+-----------------------+---------+-----+---------+-------------+
+-----------------------+---------+-----+---------+-------------+
|       imm[11:0]       |   rs1   |0 0 0|   rd    |1 1 0 0 1 1 1| I-jalr
+-----------------------+---------+-----+---------+-------------+
|       imm[11:0]       |   rs1   |0 0 0|   rd    |0 0 0 0 0 1 1| I-lb
+-----------------------+---------+-----+---------+-------------+
|       imm[11:0]       |   rs1   |0 0 1|   rd    |0 0 0 0 0 1 1| I-lh
+-----------------------+---------+-----+---------+-------------+
|       imm[11:0]       |   rs1   |0 1 0|   rd    |0 0 0 0 0 1 1| I-lw
+-----------------------+---------+-----+---------+-------------+
|       imm[11:0]       |   rs1   |1 0 0|   rd    |0 0 0 0 0 1 1| I-lbu
+-----------------------+---------+-----+---------+-------------+
|       imm[11:0]       |   rs1   |1 0 1|   rd    |0 0 0 0 0 1 1| I-lhu
+-----------------------+---------+-----+---------+-------------+
|       imm[11:0]       |   rs1   |0 0 0|   rd    |0 0 1 0 0 1 1| I-addi
+-----------------------+---------+-----+---------+-------------+
|       imm[11:0]       |   rs1   |0 1 0|   rd    |0 0 1 0 0 1 1| I-slti
+-----------------------+---------+-----+---------+-------------+
|       imm[11:0]       |   rs1   |0 1 1|   rd    |0 0 1 0 0 1 1| I-sltiu
+-----------------------+---------+-----+---------+-------------+
|       imm[11:0]       |   rs1   |1 0 0|   rd    |0 0 1 0 0 1 1| I-xori
+-----------------------+---------+-----+---------+-------------+
|       imm[11:0]       |   rs1   |1 1 0|   rd    |0 0 1 0 0 1 1| I-ori
+-----------------------+---------+-----+---------+-------------+
|       imm[11:0]       |   rs1   |1 1 1|   rd    |0 0 1 0 0 1 1| I-andi
+-----------------------+---------+-----+---------+-------------+
|0 0 0 0 0 0 0|  shamt  |   rs1   |0 0 1|   rd    |0 0 1 0 0 1 1| I-slli
+-----------------------+---------+-----+---------+-------------+
|0 0 0 0 0 0 0|  shamt  |   rs1   |1 0 1|   rd    |0 0 1 0 0 1 1| I-srli
+-----------------------+---------+-----+---------+-------------+
|0 1 0 0 0 0 0|  shamt  |   rs1   |1 0 1|   rd    |0 0 1 0 0 1 1| I-srai
+-----------------------+---------+-----+---------+-------------+
|0 0 0 0| pred  | succ  |0 0 0 0 0|0 0 0|0 0 0 0 0|0 0 0 1 1 1 1| I-fence
+-----------------------+---------+-----+---------+-------------+
|0 0 0 0|0 0 0 0|0 0 0 0|0 0 0 0 0|0 0 1|0 0 0 0 0|0 0 0 1 1 1 1| I-fence.i
+-----------------------+---------+-----+---------+-------------+
|0 0 0 0 0 0 0 0 0 0 0 0|0 0 0 0 0| 0 0 |0 0 0 0 0|1 1 1 0 0 1 1| I-ecall
+-----------------------+---------+-----+---------+-------------+
|0 0 0 0 0 0 0 0 0 0 0 0|0 0 0 0 0|0 0 0|0 0 0 0 0|1 1 1 0 0 1 1| I-ebreak
+-----------------------+---------+-----+---------+-------------+
|          csr          |   rs1   |0 0 1|   rd    |1 1 1 0 0 1 1| I-csrrw
+-----------------------+---------+-----+---------+-------------+
|          csr          |   rs1   |0 1 0|   rd    |1 1 1 0 0 1 1| I-csrrs
+-----------------------+---------+-----+---------+-------------+
|          csr          |   rs1   |0 1 1|   rd    |1 1 1 0 0 1 1| I-csrrc
+-----------------------+---------+-----+---------+-------------+
|          csr          |  zimm   |1 0 1|   rd    |1 1 1 0 0 1 1| I-csrrwi
+-----------------------+---------+-----+---------+-------------+
|          csr          |  zimm   |1 1 0|   rd    |1 1 1 0 0 1 1| I-csrrsi
+-----------------------+---------+-----+---------+-------------+
|          csr          |  zimm   |1 1 1|   rd    |1 1 1 0 0 1 1| I-csrrci
+-----------------------+---------+-----+---------+-------------+
+-------------+---------+---------+-----+---------+-------------+
|  imm[11:5]  |   rs2   |   rs1   |0 0 0|imm[4:0] |0 1 0 0 0 1 1| S-sb
+-------------+---------+---------+-----+---------+-------------+
|  imm[11:5]  |   rs2   |   rs1   |0 0 1|imm[4:0] |0 1 0 0 0 1 1| S-sh
+-------------+---------+---------+-----+---------+-------------+
|  imm[11:5]  |   rs2   |   rs1   |0 1 0|imm[4:0] |0 1 0 0 0 1 1| S-sw
+-------------+---------+---------+-----+---------+-------------+
+-------------+---------+---------+-----+---------+-------------+
|i| imm[10:5] |   rs2   |   rs1   |0 0 0|  imm  |i|1 1 0 0 0 1 1| B-beq
+-------------+---------+---------+-----+---------+-------------+
|i| imm[10:5] |   rs2   |   rs1   |0 0 1|  imm  |i|1 1 0 0 0 1 1| B-bne
+-------------+---------+---------+-----+---------+-------------+
|i| imm[10:5] |   rs2   |   rs1   |1 0 0|  imm  |i|1 1 0 0 0 1 1| B-blt
+-------------+---------+---------+-----+---------+-------------+
|i| imm[10:5] |   rs2   |   rs1   |1 0 1|  imm  |i|1 1 0 0 0 1 1| B-bge
+-------------+---------+---------+-----+---------+-------------+
|i| imm[10:5] |   rs2   |   rs1   |1 1 0|  imm  |i|1 1 0 0 0 1 1| B-bltu
+-------------+---------+---------+-----+---------+-------------+
|i| imm[10:5] |   rs2   |   rs1   |1 1 1|  imm  |i|1 1 0 0 0 1 1| B-bgeu
+-------------+---------+---------+-----+---------+-------------+
+---------------------------------------+---------+-------------+
|            imm[31:12]                 |   rd    |0 1 1 0 1 1 1| U-lui
+---------------------------------------+---------+-------------+
|            imm[31:12]                 |   rd    |0 0 1 0 1 1 1| U-auipc
+---------------------------------------+---------+-------------+
+---------------------------------------+---------+-------------+
|i|     imm[10:1]     |i|  imm[19:12]   |   rd    |1 1 0 1 1 1 1| J-jal
+---------------------------------------+---------+-------------+
```

## 2. Features
| NO | Features                                  | Advantages |
| -- | ----------------------------------------- | ---------- |
| 1  | only six formats and length fixed 32 bits | simplify instructions decoding |
| 2  | three register operands                   | reduce the number of instructions |
| 3  | the specifiers of the registers to read and written are always in the same location in all instructions | the register aceesees can begin before decoding the instruction |
| 4  | immediate fields are always sign extended, and the sign bit always in the most significant bit of the instruction | sign extension of the immediate before decoding the instruction |
